<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô - Tokenizer + Corpus</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-4">
        <h1>üß™ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô</h1>
        
        <div class="row">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h5>üìö Corpus Server (Port 5000)</h5>
                    </div>
                    <div class="card-body">
                        <div id="corpusStatus" class="alert alert-secondary">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö...</div>
                        <button id="testCorpus" class="btn btn-primary">‡∏ó‡∏î‡∏™‡∏≠‡∏ö Corpus API</button>
                    </div>
                </div>
            </div>
            
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h5>üî§ Tokenizer Server (Port 5001)</h5>
                    </div>
                    <div class="card-body">
                        <div id="tokenizerStatus" class="alert alert-secondary">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö...</div>
                        <button id="testTokenizer" class="btn btn-primary">‡∏ó‡∏î‡∏™‡∏≠‡∏ö Tokenizer API</button>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="card mt-4">
            <div class="card-header">
                <h5>üîÑ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô</h5>
            </div>
            <div class="card-body">
                <div class="mb-3">
                    <label class="form-label">‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏î‡∏™‡∏≠‡∏ö:</label>
                    <input type="text" id="testText" class="form-control" value="‡∏Å‡∏≤‡∏£‡∏à‡∏ô‡∏ö‡∏∏‡∏£‡∏µ ‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ó‡∏µ‡πà‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏°">
                </div>
                <div class="d-flex gap-2 mb-3">
                    <button id="testTokenize" class="btn btn-info">üî§ ‡∏ï‡∏±‡∏î‡∏Ñ‡∏≥</button>
                    <button id="testCorpusView" class="btn btn-success">üìö ‡∏î‡∏π Corpus</button>
                </div>
                <div id="results" class="mt-3"></div>
            </div>
        </div>
    </div>

    <script>
        class IntegrationTester {
            constructor() {
                this.corpusUrl = 'http://localhost:5000';
                this.tokenizerUrl = 'http://localhost:5001';
                this.init();
            }

            init() {
                document.getElementById('testCorpus').addEventListener('click', () => this.testCorpusServer());
                document.getElementById('testTokenizer').addEventListener('click', () => this.testTokenizerServer());
                document.getElementById('testTokenize').addEventListener('click', () => this.testTokenize());
                document.getElementById('testCorpusView').addEventListener('click', () => this.testCorpusView());
                
                this.checkServers();
            }

            async checkServers() {
                // Check Corpus Server
                try {
                    const response = await fetch(`${this.corpusUrl}/api/corpus`);
                    if (response.ok) {
                        document.getElementById('corpusStatus').className = 'alert alert-success';
                        document.getElementById('corpusStatus').textContent = '‚úÖ Corpus Server ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô';
                    } else {
                        throw new Error('Not responding');
                    }
                } catch (error) {
                    document.getElementById('corpusStatus').className = 'alert alert-danger';
                    document.getElementById('corpusStatus').textContent = '‚ùå Corpus Server ‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô';
                }

                // Check Tokenizer Server
                try {
                    const response = await fetch(`${this.tokenizerUrl}/api/health`);
                    if (response.ok) {
                        document.getElementById('tokenizerStatus').className = 'alert alert-success';
                        document.getElementById('tokenizerStatus').textContent = '‚úÖ Tokenizer Server ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô';
                    } else {
                        throw new Error('Not responding');
                    }
                } catch (error) {
                    document.getElementById('tokenizerStatus').className = 'alert alert-danger';
                    document.getElementById('tokenizerStatus').textContent = '‚ùå Tokenizer Server ‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô';
                }
            }

            async testCorpusServer() {
                try {
                    const response = await fetch(`${this.corpusUrl}/api/corpus`);
                    const data = await response.json();
                    this.showResult('Corpus Server Response', data);
                } catch (error) {
                    this.showError('Corpus Server Error', error.message);
                }
            }

            async testTokenizerServer() {
                try {
                    const response = await fetch(`${this.tokenizerUrl}/api/health`);
                    const data = await response.json();
                    this.showResult('Tokenizer Server Response', data);
                } catch (error) {
                    this.showError('Tokenizer Server Error', error.message);
                }
            }

            async testTokenize() {
                const text = document.getElementById('testText').value;
                try {
                    const response = await fetch(`${this.tokenizerUrl}/api/tokenize`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ text })
                    });
                    const data = await response.json();
                    this.showResult('Tokenize Result', data);
                } catch (error) {
                    this.showError('Tokenize Error', error.message);
                }
            }

            async testCorpusView() {
                try {
                    const response = await fetch(`${this.corpusUrl}/api/corpus`);
                    const data = await response.json();
                    this.showResult('Current Corpus', data);
                } catch (error) {
                    this.showError('Corpus View Error', error.message);
                }
            }

            showResult(title, data) {
                const resultsDiv = document.getElementById('results');
                resultsDiv.innerHTML = `
                    <div class="alert alert-success">
                        <h6>${title}</h6>
                        <pre class="mb-0">${JSON.stringify(data, null, 2)}</pre>
                    </div>
                `;
            }

            showError(title, message) {
                const resultsDiv = document.getElementById('results');
                resultsDiv.innerHTML = `
                    <div class="alert alert-danger">
                        <h6>${title}</h6>
                        <p class="mb-0">${message}</p>
                    </div>
                `;
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            new IntegrationTester();
        });
    </script>
</body>
</html>